<f:view xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:eye="http://jsfcomponents.eyeline.mobi"
        xmlns:ips="http://ips.eyeline.mobi/jsf/facelets"
        >

  <ui:composition template="/templates/main.xhtml">

    <ui:define name="head">
      <link rel="STYLESHEET" type="text/css"
            href="#{facesContext.externalContext.requestContextPath}/resources/pages/profilepage.less"/>
    </ui:define>

    <ui:define name="scripts">
      <script type="text/javascript">
        //    <![CDATA[
        $(function () {
          if (#{profilePageController.updateOk}) {
            ips.message.info("#{bundle['profile.edit.message.success']}");
          }

        });
        //    ]]>
      </script>
    </ui:define>

    <ui:define name="content">

      <div id="profilePage">
        <h:form enctype="multipart/form-data" id="content" prependId="false">

          <h:panelGroup layout="block" styleClass="border-shadow">

            <h:panelGrid columns="2" styleClass="page-header">
              <h:outputText value="#{bundle['profile.edit.title']}"/>
            </h:panelGrid>

            <h:panelGroup id="profilePageBody" layout="block" styleClass="page-body">
              <div style="margin:10px"></div>

              <h:panelGrid columns="2">
                <h:outputLabel value="#{bundle['profile.edit.fio']}"
                               for="fullName"/>
                <eye:inputText id="fullName"
                               value="#{profilePageController.user.fullName}"/>

                <h:outputLabel value="#{bundle['profile.edit.email']}"
                               for="email" />
                <eye:inputText id="email"
                               value="#{profilePageController.user.email}"/>
              </h:panelGrid>

              <h:panelGroup layout="block" styleClass="headerWithBottomSeparator">
                <h:outputText  value="#{bundle['profile.edit.changepassword']}"/>
              </h:panelGroup>

              <h:panelGrid columns="2">
                <h:outputLabel value="#{bundle['profile.edit.currentpassword']}"
                               for="currentPassword"/>
                <ips:inputText id="currentPassword"
                               secret="true"
                               value="#{profilePageController.currentPassword}"/>

                <h:outputLabel value="#{bundle['profile.edit.newpassword']}"
                               for="newPassword" />
                <ips:inputText id="newPassword"
                               secret="true"
                               validator="loginPasswordValidator"
                               validatorMessage="#{bundle['profile.edit.message.password.validation']}"
                               value="#{profilePageController.newPassword}"/>

                <h:outputLabel value="#{bundle['profile.edit.confirmpassword']}"
                               for="newPasswordConfirmation" />
                <ips:inputText id="newPasswordConfirmation"
                               secret="true"
                               value="#{profilePageController.newPasswordConfirmation}"/>
              </h:panelGrid>
               <div style="margin:10px"></div>
              <eye:buttons>
                <eye:button>
                  <h:commandLink styleClass="button-green" value="#{bundle['profile.edit.save.btn']}"
                                 action="#{profilePageController.saveProfile}" />
                </eye:button>
                <eye:button>
                  <h:commandLink styleClass="button-green" value="#{bundle['profile.edit.cancel.btn']}"
                                 action="LOGIN"/>
                </eye:button>
                <eye:space/>
              </eye:buttons>
            </h:panelGroup>


            <h:panelGroup layout="block" styleClass="page-footer"/>

          </h:panelGroup>
        </h:form>
      </div>

    </ui:define>

  </ui:composition>

</f:view>
